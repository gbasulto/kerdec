---
title: "Kernel Density Deconvolution"
author: "Guillermo Basulto-Elias"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

It is desired to provide a nonparametric density estimator of a random vector $\boldsymbol{X}$ a random vector in $\mathbb{R}^d$ based on samples contaminated with additive error $\boldsymbol{\epsilon}$ say
$$\boldsymbol{Y} = \boldsymbol{X} + \boldsymbol{\epsilon}.$$


Let $\boldsymbol{X}_1, \ldots, \boldsymbol{X}_n$ be a sample of independent and identically distributed (_iid_) random vectors in $\mathbb{R}^d$. Suppose that it is desired to provide a density estimator 

where for $i = 1, \ldots, n$,
$$\boldsymbol{Y}_i = \boldsymbol{X}_i + \boldsymbol{\epsilon}_i$$. 

Kernel deconvolution formula.

$$
\hat{f}_{\boldsymbol{X}}(\boldsymbol{x}) = 
    \frac{1}{(2\pi)^d}
    \int e^{-\imath \langle \boldsymbol{x}, \boldsymbol{t} \rangle}
    \hat{\phi}_{\boldsymbol{Y}, n}(\boldsymbol{t})
    \frac{K^{Ft}(H^{-1/2}\boldsymbol{t})}
         {\hat{\phi}_{\boldsymbol{\epsilon}}(\boldsymbol{t})}
    d\boldsymbol{t}
$$

## Kernel deconvolution density estimation on panel data


```{r}
library(kerdec)

kerdec_dens_panel_1d_cpp(matrix(rnorm(12), 3, 4), h = .5, lower = -2, upper = 2,
                         resolution = 64, ker = 1)

```

